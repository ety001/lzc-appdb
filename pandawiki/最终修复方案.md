# PandaWiki æœ€ç»ˆä¿®å¤æ–¹æ¡ˆ

## ğŸ¯ æ ¹æœ¬é—®é¢˜è¯†åˆ«

é€šè¿‡æ—¥å¿—åˆ†æå‘ç°ï¼Œé—®é¢˜çš„æ ¹æºæ˜¯**æœåŠ¡åä¸åŒ¹é…**ï¼š
- API æœåŠ¡å¯»æ‰¾ `panda-wiki-postgres` è€Œä¸æ˜¯ `postgres`
- Consumer æœåŠ¡ä½¿ç”¨ç¡¬ç¼–ç  IP `169.254.15.13:4222`
- Nginx é…ç½®å¯»æ‰¾ `panda-wiki-api:8000`

è¿™è¯´æ˜ PandaWiki çš„é•œåƒå†…éƒ¨æœ‰ç¡¬ç¼–ç çš„æœåŠ¡åé…ç½®ã€‚

## âœ… æœ€ç»ˆè§£å†³æ–¹æ¡ˆ

### æ¢å¤åŸå§‹æœåŠ¡å
å°†æ‰€æœ‰æœåŠ¡åæ”¹å›ä¸åŸå§‹ docker-compose.yml ä¸€è‡´ï¼š

```yaml
services:
  panda-wiki-nginx     # åŸ: nginx
  panda-wiki-app       # åŸ: frontend  
  panda-wiki-api       # åŸ: api
  panda-wiki-consumer  # åŸ: consumer
  panda-wiki-postgres  # åŸ: postgres
  panda-wiki-redis     # åŸ: redis
  panda-wiki-minio     # åŸ: minio
  panda-wiki-nats      # åŸ: nats
  panda-wiki-qdrant    # åŸ: qdrant
  panda-wiki-crawler   # åŸ: crawler
  panda-wiki-raglite   # åŸ: raglite
```

### å…³é”®ä¿®å¤ç‚¹

1. **db-init æœåŠ¡ä¼˜åŒ–**:
   - æ·»åŠ å¥åº·æ£€æŸ¥é…ç½®
   - start_period è®¾ç½®ä¸º 180s
   - ç¡®ä¿æ•°æ®åº“åˆå§‹åŒ–å®Œæˆ

2. **æœåŠ¡é—´è¿æ¥ä¿®å¤**:
   - æ‰€æœ‰æœåŠ¡ä½¿ç”¨å®Œæ•´çš„ `panda-wiki-*` æœåŠ¡å
   - ç¯å¢ƒå˜é‡ä¸­çš„ä¸»æœºåå…¨éƒ¨æ›´æ–°
   - ä¾èµ–å…³ç³»ä½¿ç”¨æ­£ç¡®çš„æœåŠ¡å

3. **è·¯ç”±é…ç½®æ›´æ–°**:
   - application.routes æŒ‡å‘ `panda-wiki-nginx:8080`

## ğŸ”§ å…·ä½“ä¿®æ”¹å†…å®¹

### æœåŠ¡åæ˜ å°„
- `nginx` â†’ `panda-wiki-nginx`
- `frontend` â†’ `panda-wiki-app`
- `api` â†’ `panda-wiki-api`
- `consumer` â†’ `panda-wiki-consumer`
- `postgres` â†’ `panda-wiki-postgres`
- `redis` â†’ `panda-wiki-redis`
- `minio` â†’ `panda-wiki-minio`
- `nats` â†’ `panda-wiki-nats`
- `qdrant` â†’ `panda-wiki-qdrant`
- `crawler` â†’ `panda-wiki-crawler`
- `raglite` â†’ `panda-wiki-raglite`

### ç¯å¢ƒå˜é‡æ›´æ–°
```yaml
panda-wiki-raglite:
  environment:
    - DATABASE_HOST=panda-wiki-postgres
    - MINIO_HOST=panda-wiki-minio:9000
    - QDRANT_HOST=panda-wiki-qdrant
    - MQ_NATS_URL=nats://panda-wiki-nats:4222

panda-wiki-crawler:
  environment:
    - MQ_NATS_URL=nats://panda-wiki-nats:4222
    - OSS_MINIO_ENDPOINT=panda-wiki-minio:9000
```

### db-init æœåŠ¡å¢å¼º
```yaml
db-init:
  health_check:
    test: ["CMD-SHELL", "echo 'DB init completed'"]
    start_period: 180s
```

## ğŸ“‹ é¢„æœŸæ•ˆæœ

ä¿®å¤ååº”è¯¥è§£å†³ä»¥ä¸‹é—®é¢˜ï¼š
1. âœ… API æœåŠ¡èƒ½æ‰¾åˆ° `panda-wiki-postgres`
2. âœ… Consumer æœåŠ¡èƒ½è¿æ¥åˆ° `panda-wiki-nats:4222`
3. âœ… Nginx èƒ½æ‰¾åˆ° `panda-wiki-api:8000`
4. âœ… Raglite èƒ½è¿æ¥åˆ° `panda-wiki-qdrant:6333`
5. âœ… æ‰€æœ‰æœåŠ¡é—´é€šä¿¡æ­£å¸¸

## ğŸš€ éƒ¨ç½²å»ºè®®

1. **é‡æ–°éƒ¨ç½²åº”ç”¨**
2. **ç›‘æ§å¯åŠ¨æ—¥å¿—**ï¼Œç¡®è®¤ï¼š
   - db-init æˆåŠŸåˆ›å»ºæ•°æ®åº“
   - æ‰€æœ‰æœåŠ¡èƒ½æ‰¾åˆ°å¯¹åº”çš„ä¾èµ–æœåŠ¡
   - æ²¡æœ‰ "host not found" æˆ– "connection refused" é”™è¯¯
3. **éªŒè¯åŠŸèƒ½**ï¼š
   - è®¿é—®åº”ç”¨ä¸»é¡µ
   - æµ‹è¯•åŸºæœ¬åŠŸèƒ½

## ğŸ“ ç»éªŒæ€»ç»“

1. **ä¿æŒæœåŠ¡åä¸€è‡´æ€§**ï¼šç§»æ¤æ—¶åº”ä¿æŒä¸åŸå§‹é…ç½®ä¸€è‡´çš„æœåŠ¡å
2. **é•œåƒå†…éƒ¨é…ç½®**ï¼šéœ€è¦è€ƒè™‘é•œåƒå†…éƒ¨å¯èƒ½æœ‰ç¡¬ç¼–ç çš„é…ç½®
3. **é€æ­¥è°ƒè¯•**ï¼šé€šè¿‡æ—¥å¿—åˆ†æé€æ­¥å®šä½é—®é¢˜æ ¹æº
4. **å¥åº·æ£€æŸ¥é‡è¦æ€§**ï¼šé€‚å½“çš„å¥åº·æ£€æŸ¥å’Œå¯åŠ¨ç­‰å¾…æ—¶é—´å¾ˆå…³é”®
